C51 COMPILER V9.00   TIMER1                                                                09/21/2014 19:25:48 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE TIMER1
OBJECT MODULE PLACED IN timer1.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE timer1.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1                                   #include <STC12C5A.h>
   2          #include <absacc.h>
   3          #include <intrins.h>
   4          #include <math.h>
   5          #include <string.h>
   6          
   7           
   8          #define uint unsigned int
   9          #define uchar unsigned char
  10          #define uchar unsigned char     
  11          #define uint unsigned int
  12          #define ulong unsigned long
  13          
  14          
  15          void counter_init(void);
  16          void sendbyte(uchar a);
  17          void init_timer0();
  18          
  19          sbit lcd_wr=P3^2;
  20          sbit lcd_rd=P3^3;
  21          sbit lcd_cs=P3^4;
  22          sbit lcd_a0=P3^6;
  23          
  24          //sbit lcd_wr=P3^3;
  25          //sbit lcd_rd=P3^4;
  26          //sbit lcd_cs=P3^5;
  27          //sbit lcd_a0=P3^6;
  28            
  29          //sbit    LED=P1^3;
  30          
  31          extern  bit  dis_all;
  32          //sbit dis_all=P5^0;
  33          sbit xreset_pin = P5^0;
  34          extern  bit  dis_fresh;
  35          
  36          uint clrdat;
  37          
  38          
  39          
  40          uchar code charA[ ]=  {0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x01,0x01,0x03,0x03,0x03,0x07,0x07,0x07,0x0E,
  41                                 0x0E,0x0E,0x0C,0x1F,0x1F,0x1C,0x38,0x38,0x38,0x78,0x70,0x00,0x00,0x00,0x00,0x00,
  42                                 0x00,0x00,0x00,0x00,0x00,0x00,0xC0,0xC0,0xC0,0xE0,0xE0,0x60,0x70,0x70,0x70,0x38,
  43                                 0x38,0x38,0x18,0xFC,0xFC,0x1C,0x0E,0x0E,0x0E,0x0F,0x07,0x00,0x00,0x00,0x00,0x00};/*
             -"A",0*/
  44          
  45          
  46          uchar code charB[ ]=  {0x00,0x00,0x00,0x00,0x00,0x00,0x3F,0x3F,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x3F,
  47                                 0x3F,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x3F,0x3F,0x00,0x00,0x00,0x00,0x00,
  48                                 0x00,0x00,0x00,0x00,0x00,0x00,0xE0,0xF0,0x38,0x1C,0x1C,0x1C,0x1C,0x1C,0x38,0xF0,
  49                                 0xF0,0x3C,0x1C,0x0E,0x0E,0x0E,0x0E,0x1E,0x3C,0xF8,0xE0,0x00,0x00,0x00,0x00,0x00};/*
             -"B",0*/
  50          
  51          uchar code charT[ ]=  {0x00,0x00,0x00,0x00,0x00,0x00,0x3F,0x3F,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,
  52                                 0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,
  53                                 0x00,0x00,0x00,0x00,0x00,0x00,0xFE,0xFE,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,
C51 COMPILER V9.00   TIMER1                                                                09/21/2014 19:25:48 PAGE 2   

  54                                 0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0x00,0x00,0x00,0x00,0x00};/*
             -"T",0*/
  55          
  56          /*
  57          uchar code hz1[ ]=    {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x3F,0x3F,0x00,0x00,0x00,
  58                                 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  59                                 0x00,0x00,0x00,0xFF,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  60                                 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFE,0xFE,0x00,0x00,0x00,
  61                                 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};/*"一",0*/
  62          
  63          
  64          /*
  65          uchar code hz2[ ]=     {0x00,0x00,0x03,0x03,0x07,0x06,0x06,0x0C,0x0C,0x1C,0x1C,0x34,0x74,0x24,0x04,0x04,
  66                                  0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x00,0x00,0x00,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,
  67                                  0x0C,0x0D,0x3F,0xFC,0x86,0x06,0x06,0x07,0x03,0x03,0x01,0x01,0x00,0x00,0x00,0x00,
  68                                  0x00,0x00,0x00,0x40,0xE0,0x70,0x20,0x00,0x08,0xFC,0xC0,0x00,0x00,0x00,0x00,0x00,
  69                                  0x00,0x00,0x80,0xCE,0xEC,0x7C,0x3C,0x00};/*"代",0*/
  70          
  71          uchar code hz1[ ]=        {0x00,0x00,0x00,0x08,0x07,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,
  72                                 0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x0C,0x0C,0x00,
  73                                                     0x00,0x00,0x00,0x00,0xFF,0x00,0x00,0x00,0x00,0x00,0x7F,0x00,0x00,0x00,0x1F,0x10,
  74                                                     0x10,0x10,0x10,0x10,0x10,0x1F,0x10,0x10,0x10,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  75                                                     0x00,0x00,0x00,0x00,0xFF,0x00,0x00,0x00,0x06,0x0F,0xF0,0x00,0x00,0x08,0xFC,0x08,
  76                                 0x08,0x08,0x08,0x08,0x08,0xF8,0x08,0x08,0x00,0x00,0x00,0x00,0x03,0x00,0x00,0x00,
  77                                                     0x00,0x00,0x00,0x10,0xF8,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,
  78                                                     0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0xF0,0xE0,0x40,0x00};/*"同",0*//* (32 
             -X 32 , 宋体 )*/
  79          
  80          uchar code hz2[ ]=        {0x00,0x00,0x00,0x00,0x00,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x3F,0x00,0x00,
  81                                 0x00,0x00,0x00,0x00,0x01,0x01,0x03,0x06,0x0C,0x18,0x00,0x00,0x00,0x00,0x1F,0x00,
  82                                                     0x00,0x00,0x00,0x00,0x00,0x80,0xC0,0x80,0x80,0x80,0x80,0x80,0x80,0xFF,0x01,0x00,
  83                                                     0x00,0x40,0xF0,0xC0,0x80,0x00,0x00,0x00,0x01,0x00,0x01,0x07,0x1C,0xE0,0x00,0x00,
  84                                                     0x00,0x00,0x80,0xC0,0x80,0x80,0x80,0xFF,0x80,0x80,0x80,0x80,0x80,0xFF,0x00,0xC0,
  85                                 0x80,0x80,0x80,0x80,0x81,0x83,0x87,0x8E,0x18,0x70,0xC0,0x80,0x00,0x00,0x00,0x00,
  86                                                     0x00,0x00,0x00,0x00,0x00,0x40,0xE0,0xF0,0x00,0x00,0x00,0x00,0x18,0xFC,0x00,0x00,
  87                                                     0x00,0x20,0x70,0xE0,0xC0,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};/*"步",0*//* (32 
             -X 32 , 宋体 )*/
  88          
  89          uchar code hz3[ ]=    {0x00,0x00,0x02,0x03,0x03,0x06,0x06,0x04,0x0F,0x0C,0x08,0x18,0x1F,0x23,0x43,0x43,
  90                                 0x03,0x03,0x3F,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x00,0x00,0x00,
  91                                                     0x00,0x00,0x00,0x80,0x00,0x00,0x30,0x38,0xC7,0x00,0x00,0x20,0xF0,0x01,0x03,0x02,
  92                                                     0x04,0x38,0xF8,0x00,0x00,0x00,0x00,0x00,0x30,0x60,0xC0,0x80,0x03,0x06,0x18,0x00,
  93                                                     0x00,0x00,0x20,0x18,0x0C,0x0E,0x04,0x00,0xFF,0x00,0x60,0xE0,0xC0,0x80,0x00,0x40,
  94                                 0x40,0x41,0x21,0x21,0x33,0x17,0x1E,0x0C,0x1E,0x37,0x63,0xC1,0x00,0x00,0x00,0x00,
  95                                                     0x00,0x00,0x00,0x00,0x00,0x00,0x18,0x3C,0xC0,0x00,0xC0,0x70,0x38,0x18,0x58,0xE0,
  96                                                     0xC0,0xC0,0x80,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0xE0,0x7E,0x38,0x00,0x00};/*"铰",0*//* (32 
             -X 32 , 宋体 )*/
  97          
  98          
  99          uchar code hz4[ ]=     {0x00,0x00,0x00,0x07,0x07,0x06,0x04,0x0C,0x0F,0x08,0x18,0x10,0x20,0x3F,0x42,0x02,
 100                                  0x02,0x02,0x3F,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x03,0x07,0x02,0x00,0x00,0x00,
 101                                                          0x00,0x00,0x00,0x00,0x00,0x08,0x24,0x76,0x87,0x03,0x02,0x40,0xE0,0x00,0x02,0x03,
 102                                                          0x3F,0x22,0xF2,0x02,0x02,0x02,0x02,0x02,0x12,0x62,0x82,0x05,0x18,0x30,0x10,0x00,
 103                                                          0x00,0x00,0x04,0x07,0x06,0x06,0x0C,0xFF,0x08,0x18,0x1A,0x13,0x33,0x33,0x63,0xFF,
 104                                  0x03,0x03,0x03,0x03,0x03,0x7F,0x03,0x03,0x03,0x03,0x03,0x03,0xE0,0x3F,0x07,0x00,
 105                                                          0x00,0x00,0x00,0x00,0x00,0x00,0x18,0xFC,0x00,0x00,0x00,0x80,0x00,0x00,0x18,0xE0,
 106                                                          0x00,0x00,0x00,0x08,0x1C,0xE0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFC,0xF8,0x00};/*"链",0*//* (32 X 
             -32 , 宋体 )*/
 107          
 108          
 109          
 110          uchar code hz5[ ]=      {0x00,0x00,0x00,0x08,0x06,0x07,0x03,0x02,0x00,0x00,0x30,0x18,0x1C,0x0C,0x09,0x01,
C51 COMPILER V9.00   TIMER1                                                                09/21/2014 19:25:48 PAGE 3   

 111                                   0x01,0x01,0x02,0x02,0x06,0x6E,0x1C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x04,0x01,0x00,
 112                                                           0x00,0x00,0x00,0x00,0x3F,0x30,0x30,0x30,0x30,0x33,0x33,0xB3,0xB3,0xB3,0x33,0x33,
 113                                                           0x33,0x32,0x32,0x32,0x32,0x36,0x26,0x05,0x0C,0x08,0x18,0x30,0x60,0xC0,0x00,0x00,
 114                                                           0x00,0x00,0x00,0x00,0xF0,0x30,0x20,0x23,0x23,0x23,0x23,0x21,0x21,0x21,0x21,0x21,
 115                                   0x31,0x31,0x31,0x31,0x33,0x23,0x03,0x03,0x80,0x40,0x60,0x30,0x31,0x10,0x00,0x00,
 116                                                           0x00,0x00,0x00,0x18,0x18,0x10,0x10,0x10,0x90,0x10,0x10,0x10,0x10,0x10,0x10,0x10,
 117                                                           0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0xF0,0x70,0x20,0x00}; /*"测",0*/ /* (32
             - X 32 , 宋体 )*/
 118          
 119          
 120          uchar code hz6[ ]=           {0x00,0x00,0x00,0x00,0x08,0x0C,0x07,0x03,0x03,0x01,0x00,0x00,0x00,0x01,0x7F,0x03,
 121                                    0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x01,0x00,0x00,
 122                                                            0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x00,0x1F,0x00,0x00,0x00,0x80,0x00,
 123                                                            0x0F,0x00,0x00,0x00,0x00,0x00,0x08,0x10,0x30,0x61,0xDF,0x8E,0x80,0x00,0x00,0x00,
 124                                                            0x00,0x00,0x00,0x06,0x07,0x06,0x06,0x06,0x06,0x06,0xFF,0x06,0x06,0x06,0x06,0x1E,
 125                                    0xE2,0x82,0x83,0x83,0x81,0x81,0x81,0x80,0x98,0xE0,0x80,0x00,0x00,0x00,0x00,0x00,
 126                                                            0x00,0x00,0x00,0x00,0xC0,0x60,0x30,0x30,0x08,0x1C,0xE0,0x00,0x00,0x00,0x00,0x00,
 127                                                            0x00,0x00,0x00,0x00,0x00,0x80,0x80,0x84,0xC4,0x64,0x64,0x34,0x1C,0x0C,0x04,0x00}; /*"试",0*/ /* (3
             -2 X 32 , 宋体 )*/
 128          
 129          
 130          uchar code hz7[ ]=           {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x01,0x01,0x03,0x03,0x07,0x05,0x09,0x09,
 131                                    0x11,0x21,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x00,
 132                                                            0x00,0x00,0x40,0x70,0xE0,0xC0,0xC0,0x80,0x80,0x04,0x02,0x82,0x82,0x01,0x01,0x01,
 133                                                            0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x81,0x83,0x8C,0x98,0x60,0x00,
 134                                                            0x00,0x00,0x00,0x40,0x60,0x30,0x30,0x18,0x18,0x18,0x00,0x00,0x01,0x01,0x01,0x83,
 135                                    0x83,0xC6,0x46,0x6C,0x2C,0x38,0x18,0x3C,0x66,0xC3,0x81,0x00,0x00,0x00,0x00,0x00,
 136                                                            0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x40,0xF0,0xE0,0xC0,0xC0,0x80,0x80,0x00,0x00,
 137                                                            0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xC0,0xF0,0x7E,0x38,0x00,0x00};/*"仪",0*//* (32 
             -X 32 , 宋体 )*/
 138          
 139          
 140          
 141          
 142          
 143          uchar code char1[ ]=    {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x1F,0x01,0x01,0x01,0x01,0x01,0x01,0x01,
 144                                   0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x03,0x1F,0x00,0x00,0x00,0x00,0x00,
 145                                                           0x00,0x00,0x00,0x00,0x00,0x00,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,
 146                                                           0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xE0,0xFC,0x00,0x00,0x00,0x00,0x00};/*"1",0*/ /* (16 X
             - 32 , 宋体, 加粗 )*/
 147          
 148          
 149          uchar code char2[ ]=     {0x00,0x00,0x00,0x00,0x00,0x00,0x07,0x0C,0x18,0x30,0x30,0x38,0x38,0x00,0x00,0x00,
 150                                    0x00,0x00,0x00,0x01,0x03,0x06,0x0C,0x18,0x30,0x3F,0x3F,0x00,0x00,0x00,0x00,0x00,
 151                                                            0x00,0x00,0x00,0x00,0x00,0x00,0xF0,0x3C,0x1C,0x0E,0x0E,0x0E,0x0E,0x0E,0x1C,0x18,
 152                                                            0x30,0x60,0xC0,0x80,0x00,0x06,0x06,0x06,0x0E,0xFC,0xFC,0x00,0x00,0x00,0x00,0x00};/*"2",0*//* (16 X
             - 32 , 宋体, 加粗 )*/
 153          
 154          
 155          uchar code char3[ ]=     {0x00,0x00,0x00,0x00,0x00,0x00,0x07,0x1C,0x38,0x38,0x38,0x38,0x00,0x00,0x00,0x03,
 156                                    0x00,0x00,0x00,0x00,0x00,0x38,0x38,0x38,0x38,0x1C,0x07,0x00,0x00,0x00,0x00,0x00,
 157                                                            0x00,0x00,0x00,0x00,0x00,0x00,0xE0,0x78,0x38,0x1C,0x1C,0x1C,0x1C,0x38,0x70,0xE0,
 158                                                            0x78,0x1C,0x0C,0x0E,0x0E,0x0E,0x0E,0x0C,0x1C,0x38,0xE0,0x00,0x00,0x00,0x00,0x00};/*"3",0*/
 159          
 160          
 161          uchar code char4[ ]=     {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x03,0x03,0x06,0x0E,0x0C,0x1C,
 162                                   0x18,0x30,0x70,0x7F,0x7F,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
 163                                   0x00,0x00,0x00,0x00,0x00,0x00,0x70,0xF0,0xF0,0xF0,0xF0,0x70,0x70,0x70,0x70,0x70,
 164                                   0x70,0x70,0x70,0xFE,0xFE,0x70,0x70,0x70,0x70,0x70,0x70,0x00,0x00,0x00,0x00,0x00};
             -/*"4",0*/
 165          
 166          
C51 COMPILER V9.00   TIMER1                                                                09/21/2014 19:25:48 PAGE 4   

 167          
 168          
 169          
 170          
 171          
 172          
 173          
 174          void delayms(uchar ms)
 175               { uchar count,i;
 176   1             _nop_();
 177   1             _nop_();
 178   1             _nop_();
 179   1             for(i=ms;i>0;i--)
 180   1               { for(count=0;count<=58;count++) {;}
 181   2                 _nop_();
 182   2               }
 183   1            }
 184          
 185                  void WriteCommand(uchar Command)   //send command    
 186                  {   
 187   1                  lcd_wr = 1;                   // init all control signal    
 188   1                  lcd_rd = 1;   
 189   1                  lcd_a0  = 1;                // for command    
 190   1                  //P2 = Command; 
 191   1                      sendbyte(Command) ;  
 192   1                  lcd_cs = 0;                // enable the access    
 193   1                  _nop_();   
 194   1                  lcd_wr = 0;   
 195   1                  _nop_();   
 196   1                  _nop_();   
 197   1                  lcd_wr = 1;   
 198   1                  _nop_();   
 199   1                  lcd_cs = 1;                // disable the access    
 200   1                  delayms(1);   
 201   1              }   
 202                     
 203                     
 204                     
 205                  void WriteData(uchar DData)    //send display data    
 206                  {   
 207   1                  lcd_wr = 1;                // init all control signal    
 208   1                  lcd_rd = 1;   
 209   1                  lcd_a0  = 0;                // for diaplay data    
 210   1                  //P2 = DData; 
 211   1                      sendbyte(DData);  
 212   1                  lcd_cs = 0;                // enable the access    
 213   1                  _nop_();   
 214   1                  lcd_wr = 0;   
 215   1                  _nop_();   
 216   1                  _nop_();   
 217   1                  lcd_wr = 1;   
 218   1                  _nop_();   
 219   1                  lcd_cs = 1;                // disable the access    
 220   1                  _nop_();   
 221   1                  _nop_();   
 222   1              }   
 223          
 224          
 225          void LCD_Init(void)
 226          {
 227   1      WriteCommand(0x40);
 228   1         WriteData(0x30);
C51 COMPILER V9.00   TIMER1                                                                09/21/2014 19:25:48 PAGE 5   

 229   1         WriteData(0x87);
 230   1         WriteData(0x07);
 231   1         WriteData(0x27); 
 232   1         WriteData(0x32);     
 233   1         WriteData(0xef);
 234   1         WriteData(0x28); 
 235   1         WriteData(0x00);
 236   1      
 237   1       WriteCommand(0x44);
 238   1         WriteData(0x00);
 239   1         WriteData(0x00);
 240   1         WriteData(0xf0);
 241   1         WriteData(0xb0); 
 242   1         WriteData(0x04);     
 243   1         WriteData(0xf0);
 244   1         WriteData(0x00); 
 245   1         WriteData(0x00);
 246   1         WriteData(0x00); 
 247   1         WriteData(0x00);
 248   1      
 249   1      WriteCommand(0x5d);
 250   1         WriteData(0x07);
 251   1         WriteData(0x07);
 252   1      
 253   1      WriteCommand(0x4f);
 254   1      
 255   1      WriteCommand(0x5a);
 256   1         WriteData(0x01);
 257   1      
 258   1      WriteCommand(0x5b);
 259   1         WriteData(0x05);
 260   1      
 261   1      //WriteCommand(0x60);
 262   1         //WriteData(0x01);
 263   1      
 264   1      WriteCommand(0x46);
 265   1         WriteData(0x00);
 266   1         WriteData(0x00);
 267   1      
 268   1      WriteCommand(0x58);
 269   1         WriteData(0x00);
 270   1      
 271   1      WriteCommand(0x59);
 272   1         WriteData(0x04);
 273   1      }
 274          
 275          
 276          void LCD_Clear(uchar dat)
 277          {
 278   1       unsigned int i;
 279   1       unsigned int j;
 280   1       for(i=0;i<40;i++)
 281   1       {
 282   2       WriteCommand(0x46);
 283   2         WriteData(i);
 284   2         WriteData(0);
 285   2       WriteCommand(0x42);
 286   2       for(j=0;j<240;j++)
 287   2       {WriteData(dat);}
 288   2        }
 289   1      }
 290          
C51 COMPILER V9.00   TIMER1                                                                09/21/2014 19:25:48 PAGE 6   

 291          
 292          
 293          
 294          
 295          
 296          
 297          
 298          
 299          
 300          
 301          void LCD_Write32x32Char(uchar addx, uchar addy, uchar code *DData)
 302          {
 303   1       unsigned int i,j;
 304   1       unsigned int tmp=0;
 305   1       unsigned int k=0;
 306   1       for(i=addx;i<addx+4;i++)
 307   1       {
 308   2       WriteCommand(0x46);
 309   2         WriteData(i);
 310   2         WriteData(addy);
 311   2       WriteCommand(0x42);
 312   2       for(j=0+k*32;j<32+k*32;j++)
 313   2       {WriteData(DData[tmp+j]);}
 314   2       k++;
 315   2        }
 316   1      }
 317          
 318          
 319          
 320          
 321          void LCD_Write32x16Char(uchar addx, uchar addy, uchar code *DData)
 322          {
 323   1       unsigned int i,j;
 324   1       unsigned int tmp=0;
 325   1       unsigned int k=0;
 326   1       for(i=addx;i<addx+2;i++)
 327   1       {
 328   2       WriteCommand(0x46);
 329   2         WriteData(i);
 330   2         WriteData(addy);
 331   2       WriteCommand(0x42);
 332   2       for(j=0+k*32;j<32+k*32;j++)
 333   2       {WriteData(DData[tmp+j]);}
 334   2       k++;
 335   2        }
 336   1      }
 337          
 338          
 339           
 340          void LCD_Write32x16Char1(uchar addx, uchar addy, uchar code *DData, uchar m)
 341          {unsigned int i,j;
 342   1       unsigned int tmp=m*64;
 343   1       unsigned int k=0;
 344   1       for(i=addx;i<addx+2;i++)
 345   1       {
 346   2       WriteCommand(0x46);
 347   2         WriteData(i);
 348   2         WriteData(addy);
 349   2       WriteCommand(0x42);
 350   2       for(j=0+k*32;j<32+k*32;j++)
 351   2       {WriteData(DData[tmp+j]);}
 352   2       k++;
C51 COMPILER V9.00   TIMER1                                                                09/21/2014 19:25:48 PAGE 7   

 353   2        }
 354   1      }
 355          
 356           void init_timer1()
 357          {
 358   1         P4SW=0xff;
 359   1         TMOD|=0X10;
 360   1         TH1=0x15;                            //如果时间要完全精确，需用12MHZ的晶振
 361   1         TL1=0xA0;
 362   1         EA=1;
 363   1         ET1=1;
 364   1         TR1=1;
 365   1      }
 366          
 367          
 368          void   LCD_Char_display(void)
 369                 {
 370   1      
 371   1         WriteCommand(0x46);
 372   1         WriteData(0x00);
 373   1         WriteData(0x00);
 374   1      
 375   1         LCD_Write32x32Char(107,1,hz1);
 376   1         LCD_Write32x32Char(112,1,hz2);
 377   1         LCD_Write32x32Char(117,1,hz3);
 378   1         LCD_Write32x32Char(122,1,hz4);
 379   1         LCD_Write32x32Char(127,1,hz5);
 380   1         LCD_Write32x32Char(132,1,hz6);
 381   1         LCD_Write32x32Char(137,1,hz7);
 382   1      
 383   1      
 384   1         LCD_Write32x16Char(115,6,charA); 
 385   1         LCD_Write32x16Char(135,6,charB);
 386   1      
 387   1      
 388   1         LCD_Write32x16Char(225,11,char1);
 389   1         LCD_Write32x16Char(33,18,char2);
 390   1         LCD_Write32x16Char(97,24,char3);
 391   1         LCD_Write32x16Char(161,30,char4);
 392   1         
 393   1                      /*
 394   1              LCD_Write32x16Char1(232,11,numb,timer1a.sec/10);
 395   1              LCD_Write32x16Char1(234,11,numb,timer1a.sec%10);
 396   1              LCD_Write32x16Char1(236,11,numb,timer1a.hsec/10);
 397   1              //LCD_Write16x8Char(48,13,dot);
 398   1                      LCD_Write32x16Char1(238,11,numb,10);
 399   1              LCD_Write32x16Char1(240,11,numb,timer1a.hsec%10);
 400   1                       
 401   1              LCD_Write32x16Char1(250,11,numb,timer1b.sec/10);
 402   1              LCD_Write32x16Char1(252,11,numb,timer1b.sec%10);
 403   1              LCD_Write32x16Char1(254,11,numb,timer1b.hsec/10);
 404   1              //LCD_Write16x8Char(63,13,dot);
 405   1                      LCD_Write32x16Char1(0,12,numb,10);
 406   1              LCD_Write32x16Char1(2,12,numb,timer1b.hsec%10);
 407   1      
 408   1      
 409   1                      LCD_Write32x16Char1(40,18,numb,timer2a.sec/10);
 410   1              LCD_Write32x16Char1(42,18,numb,timer2a.sec%10);
 411   1              LCD_Write32x16Char1(44,18,numb,timer2a.hsec/10);
 412   1              //LCD_Write16x8Char(136,20,dot);
 413   1                      LCD_Write32x16Char1(46,18,numb,10);
 414   1              LCD_Write32x16Char1(48,18,numb,timer2a.hsec%10);
C51 COMPILER V9.00   TIMER1                                                                09/21/2014 19:25:48 PAGE 8   

 415   1                      
 416   1                      LCD_Write32x16Char1(58,18,numb,timer2b.sec/10);
 417   1              LCD_Write32x16Char1(60,18,numb,timer2b.sec%10);
 418   1              LCD_Write32x16Char1(62,18,numb,timer2b.hsec/10);
 419   1              //LCD_Write16x8Char(151,20,dot);
 420   1                       LCD_Write32x16Char1(64,18,numb,10);
 421   1              LCD_Write32x16Char1(66,18,numb,timer2b.hsec%10);
 422   1      
 423   1      
 424   1      
 425   1                  LCD_Write32x16Char1(104,24,numb,timer3a.sec/10);
 426   1              LCD_Write32x16Char1(106,24,numb,timer3a.sec%10);
 427   1              LCD_Write32x16Char1(108,24,numb,timer3a.hsec/10);
 428   1              //LCD_Write16x8Char(8,28,dot);
 429   1                      LCD_Write32x16Char1(110,24,numb,10);
 430   1              LCD_Write32x16Char1(112,24,numb,timer3a.hsec%10);
 431   1                      
 432   1                      LCD_Write32x16Char1(122,24,numb,timer3b.sec/10);
 433   1              LCD_Write32x16Char1(124,24,numb,timer3b.sec%10);
 434   1              LCD_Write32x16Char1(126,24,numb,timer3b.hsec/10);
 435   1                      LCD_Write32x16Char1(128,24,numb,10);
 436   1              LCD_Write32x16Char1(130,24,numb,timer3b.hsec%10);
 437   1      
 438   1      
 439   1                      LCD_Write32x16Char1(168,30,numb,timer4a.sec/10);
 440   1              LCD_Write32x16Char1(170,30,numb,timer4a.sec%10);
 441   1              LCD_Write32x16Char1(172,30,numb,timer4a.hsec/10);
 442   1              //LCD_Write16x8Char(8,28,dot);
 443   1                      LCD_Write32x16Char1(174,30,numb,10);
 444   1              LCD_Write32x16Char1(176,30,numb,timer4a.hsec%10);
 445   1      
 446   1                      LCD_Write32x16Char1(186,30,numb,timer4b.sec/10);
 447   1              LCD_Write32x16Char1(188,30,numb,timer4b.sec%10);
 448   1              LCD_Write32x16Char1(190,30,numb,timer4b.hsec/10);
 449   1                      LCD_Write32x16Char1(192,30,numb,10);
 450   1              LCD_Write32x16Char1(194,30,numb,timer4b.hsec%10);
 451   1                      */
 452   1      
 453   1         WriteCommand(0x46);
 454   1         WriteData(0x10);
 455   1         WriteData(0x26);     
 456   1         
 457   1                
 458   1                }
 459          
 460          void timer1() interrupt 3 using 2
 461          {
 462   1      /******************刷新显示*****************************/  
 463   1         CLK_DIV=0X00;
 464   1         TH1=0x15;                            //如果时间要完全精确，需用12MHZ的晶振
 465   1         TL1=0xA0;
 466   1      /*******************如果全显示标志为1，所有显示刷新并清屏***********/
 467   1              if(!xreset_pin){
 468   2              dis_all = 1;
 469   2              }
 470   1      
 471   1         if(dis_all)
 472   1         {
 473   2      //   TR1=0;
 474   2      //   ET1=0;
 475   2         TR0=0;
 476   2      
C51 COMPILER V9.00   TIMER1                                                                09/21/2014 19:25:48 PAGE 9   

 477   2      counter_init();
 478   2      dis_fresh=0;
 479   2      init_timer0();      //定时器0初始化，按键扫描，计时，动作时间控制
 480   2              
 481   2      
 482   2         LCD_Clear(0x00);
 483   2         LCD_Clear(0x00);
 484   2         LCD_Char_display();
 485   2         LCD_Char_display();
 486   2         dis_all=0;
 487   2         dis_fresh=1;   
 488   2         TR0=1;
 489   2         }
 490   1      
 491   1         
 492   1        } 
 493             


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   1055    ----
   CONSTANT SIZE    =   1344    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2      42
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
